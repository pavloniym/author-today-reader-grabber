# Author.Today Reader Grabber

Скрипт на Node.js, который открывает страницу книги на Author.Today через Puppeteer, выгружает все главы и собирает из них FB2-файл с обложкой. Готовая книга сохраняется в папку `books`.

## Требования
- Node.js версии 18 или выше (соответствует требованиям Puppeteer 24)
- Установленные зависимости проекта: `npm install`
- Активная подписка/права на чтение книги на Author.Today и действующие cookies аккаунта

## Подготовка
1. Установите зависимости: `npm install`.
2. Авторизуйтесь на [Author.Today](https://author.today/) в обычном браузере.
3. Экспортируйте cookies вашего браузера в файл `cookies.json` в корне проекта.
   - Проще всего сделать это через DevTools: `Application` → `Storage` → `Cookies` → скопируйте все cookie домена `author.today` и сохраните в JSON-массив.
   - Или воспользуйтесь расширением (например, Chrome [EditThisCookie](https://chromewebstore.google.com/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg)): экспортируйте cookies домена `author.today` в JSON и сохраните файл как `cookies.json`.
   - Формат файла: массив объектов в формате Puppeteer. Пример:
     ```json
     [
       {
         "name": "at_auth",
         "value": "...",
         "domain": ".author.today",
         "path": "/",
         "httpOnly": true,
         "secure": true
       }
     ]
     ```
4. Убедитесь, что в каталоге есть папка `books` (скрипт создаёт её автоматически, если нужно).

## Запуск
```bash
node grabber.js https://author.today/reader/XXXXX/YYYYYYY
```
- URL берите из режима чтения книги (`/reader/...`).
- Во время работы откроется окно Chromium от Puppeteer с вашими cookies.
- Скрипт обходит все главы, скачивает текст и обложку, затем формирует FB2-файл.

После завершения в папке `books` появятся:
- `Название_книги.fb2` — собранный файл книги.
- `Название_книги_cover.jpg` — скачанная обложка (используется при генерации FB2).

## Советы и устранение неполадок
- Если скрипт не видит главы, убедитесь, что у аккаунта есть доступ к книге и cookies не устарели.
- При ошибках авторизации удалите `cookies.json`, снова экспортируйте cookies и повторите запуск.
- Менять режим headless можно в `grabber.js`, параметр `headless: false` внутри `puppeteer.launch`.
- При большом количестве глав увеличьте таймауты или добавьте дополнительные задержки между запросами.

## Юридическое напоминание
Используйте инструмент только для личного чтения и в соответствии с правилами платформы Author.Today.
